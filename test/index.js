!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.PartlyRecognized="partly-recognized",e.FullyRecognized="recognized",e.VoicesReady="voices-ready",e.PermissionStatusReady="permissions-ready",e.Ready="ready"}(i||(i={})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Events=void 0;const i=n(2),r=n(0);t.Events=r.default,t.default=i.default},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(3),s=n(0),o=n(6),a=n(7),u=n(8);class l{constructor(e){this.eventTarget=new EventTarget,this.isRecognitionActive=!1,e=Object.assign(Object.assign({},u.defaultFeatures),e),this.silent=e.silent,this.ready=this.detectFeatures(e),this.ready?(e.recognition&&(this.recognizer=Object.assign(Object.assign({},this.recognizer),u.recognizerDefaults),this.recognizer.onresult=e=>{const t=e.results[e.resultIndex];t.isFinal?this.fullyRecognized(t[0].transcript):this.partlyRecognized(t[0].transcript)}),Promise.all([new Promise((t,n)=>{e.synthesis?this.getVoices().then(e=>{this.voices=e,this.activeVoice=e[0],this.dispatch(s.default.VoicesReady),t()}).catch(()=>{this.throw(r.default.UnableGetVoices),n()}):t()}),new Promise((t,n)=>{e.recognition?this.getPermissionStatus().then(e=>{this.permissionStatus=e.state,this.dispatch(s.default.PermissionStatusReady)}).catch(()=>{this.throw(r.default.NotSupportPermissions),n()}):t()})]).then(()=>{this.dispatch(s.default.Ready)}).catch(()=>{this.throw(r.default.InstanceNotCreated)})):this.throw(r.default.InstanceNotCreated)}dispatch(e,t){this.eventTarget.dispatchEvent(new o.default(e,t))}on(e,t,n){this.eventTarget.addEventListener(e,t,n)}throw(e){this.silent||e.throw()}detectFeatures(e){var t,n;const i=l.availableFeatures;if(e.translation){if(!i.translation)return this.throw(r.default.NotSupportFetch),!1;this.fetch=self.fetch.bind(self)}if(e.synthesis){if(!i.synthesis)return this.throw(r.default.NotSupportSynthesis),!1;this.synthesizer=self.speechSynthesis}if(e.recognition){if(!i.recognition)return this.throw(r.default.NotSupportRecognition),!1;this.recognizer=new(self.speechRecognition||self.webkitSpeechRecognition),this.permissions=null===(t=self.navigator)||void 0===t?void 0:t.permissions,this.mediaDevices=null===(n=self.navigator)||void 0===n?void 0:n.mediaDevices}return!0}static get availableFeatures(){var e,t;return{recognition:!(!self.speechRecognition&&!self.webkitSpeechRecognition||!(null===(e=self.navigator)||void 0===e?void 0:e.mediaDevices)||!(null===(t=self.navigator)||void 0===t?void 0:t.permissions)),translation:!!self.fetch,synthesis:!!self.speechSynthesis}}getVoices(){return i(this,void 0,void 0,(function*(){let e,t=0;return new Promise((n,i)=>{e=setInterval(()=>{t>=100&&(clearInterval(e),i());const r=this.synthesizer.getVoices();(null==r?void 0:r.length)&&(clearInterval(e),n(r.map((e,t)=>new a.default(t,e)))),t+=1},10)})}))}getPermissionStatus(e=u.permissionsQueryDefault){return i(this,void 0,void 0,(function*(){return this.permissions.query(e)}))}requestPermission(e=u.mediaStreamConstraintsDefault){return i(this,void 0,void 0,(function*(){try{return this.mediaStream=yield this.mediaDevices.getUserMedia(e),this.getPermissionStatus(),this.mediaStream}catch(e){this.silent||r.default.PermissionDeclined.throw()}}))}setActiveVoice(e){let t;return t="number"==typeof e?this.voices.find(t=>t.id===e):this.voices.find(t=>t.name.toLocaleLowerCase().includes(e.toLocaleLowerCase())||t.lang.toLocaleLowerCase().includes(e.toLocaleLowerCase())),t||this.silent||(r.default.WrongVoice.throw(),self.navigator.onLine||r.default.DueToOffline.throw()),this.activeVoice=t,t}get recognitionLang(){return this.recognizer.lang}set recognitionLang(e){this.recognizer.lang=e}speak(e){if(!e)return;const t=new SpeechSynthesisUtterance(e);t.voice=this.activeVoice.voice,this.synthesizer.speak(t)}translate(e,t){return i(this,void 0,void 0,(function*(){if(!e)return this.silent||r.default.NothingToTranslate.throw(),!1;if(!t)return this.silent||r.default.WrongLanguage.throw(),!1;if(!self.navigator.onLine)return this.silent||(r.default.TranslationUnavilable.throw(),r.default.DueToOffline.throw()),!1;const n=new URL(u.googleRequersDefaults.url);n.search=new URLSearchParams(Object.assign(Object.assign({},u.googleRequersDefaults.params),{tl:t,q:e})).toString();try{const e=yield this.fetch(n);if(!e.ok)return this.silent||r.default.TranslationError.throw(),!1;const t=yield e.json();return t[0]?t[0][0][0]:(this.silent||r.default.NothingToTranslate.throw(),!1)}catch(e){return this.silent||r.default.TranslationError.throw(),!1}}))}startRecognition(){"granted"===this.permissionStatus?this.isRecognitionActive?this.silent||r.default.RecognitionActive.throw():(this.isRecognitionActive=!0,this.recognizer.start()):this.silent||r.default.PermissionDeclined.throw()}stopRecognition(){this.isRecognitionActive&&(this.isRecognitionActive=!1,this.recognizer.stop())}partlyRecognized(e){this.dispatch(s.default.PartlyRecognized,e)}fullyRecognized(e){this.dispatch(s.default.FullyRecognized,e)}}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4),r=n(5),s={NotSupportRecognition:new i.default(r.default.Error,"This browser does not support Speech Recognition feature."),NotSupportSynthesis:new i.default(r.default.Error,"This browser does not support Speech Synthesis feature."),NotSupportFetch:new i.default(r.default.Error,"This browser does not support Fetch feature."),NotSupportMedia:new i.default(r.default.Error,"This browser does not support Media Devices feature."),NotSupportPermissions:new i.default(r.default.Error,"This browser does not support Permissions feature."),InstanceNotCreated:new i.default(r.default.Error,"Instance was not created."),UnableGetVoices:new i.default(r.default.Error,"Unable to get voices."),WrongVoice:new i.default(r.default.Warn,"Wrong Voice ID."),TranslationUnavilable:new i.default(r.default.Warn,"Transtalion is unavailable."),TranslationError:new i.default(r.default.Warn,"Transtalion service error."),DueToOffline:new i.default(r.default.Warn,"This could be due to the fact that you're offline."),PermissionDeclined:new i.default(r.default.Warn,"User did not give permission."),RecognitionActive:new i.default(r.default.Warn,"Recognition already active."),NothingToTranslate:new i.default(r.default.Warn,"Nothing to translate."),WrongLanguage:new i.default(r.default.Warn,"Wrong translation language.")};t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t){this.type=e,this.message=t}throw(){const e=`[TranSpeech ${this.type}]: ${this.message}`;console[this.type](e)}}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Error="error",e.Warn="warn"}(i||(i={})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Event{constructor(e,t){super(e),void 0!==typeof t&&(this.result=t)}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t){this.id=e,this.name=t.name,this.lang=t.lang,this.offline=t.localService,this.voice=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.googleRequersDefaults=t.mediaStreamConstraintsDefault=t.permissionsQueryDefault=t.recognizerDefaults=t.defaultFeatures=void 0,t.defaultFeatures={recognition:!0,synthesis:!0,translation:!0,silent:!1},t.recognizerDefaults={continuous:!0,interimResults:!0,lang:"en"},t.permissionsQueryDefault={name:"microphone"},t.mediaStreamConstraintsDefault={audio:!0},t.googleRequersDefaults={url:"https://translate.googleapis.com/translate_a/single",params:{client:"gtx",sl:"auto",dt:"t"}}}])},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i);function s(e,t="h1",n=document.body){const i=document.createElement(t);return i.innerText=e,n.appendChild(i),i}s("1. Available Features Test");let o=r.a.availableFeatures,a=s("","ul");["synthesis","translation","recognition"].forEach(e=>{let t=e+": ";t+=o.hasOwnProperty(e)?"OK - ":"FAIL - ",t+=!!o[e],s(t,"li",a)}),s("2. Create instance"),s("2.1. Without param","h2");let u=new r.a;u instanceof r.a&&u.ready&&!u.silent?s("OK","div"):s("FAIL","div"),a=s("","ul"),["recognizer","synthesizer","fetch"].forEach(e=>{let t=e+": ";t+=u.hasOwnProperty(e)?"OK - ":"FAIL - ",t+=!!u[e],s(t,"li",a)}),u.requestPermission()}]);